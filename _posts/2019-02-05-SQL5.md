---
title: "SQL #5: CTE's, Views & JOIN"
date: 2019-02-01
tags: []
excerpt: ":five:"
mathjax: true
---

This is the fifth in a series of SQL notes I made during the [Kubrick](https://kubrickgroup.com/) Data Engineering training course. The others are:  
[#1: Database Theory]({{ site.url }}{{ site.baseurl }}/SQL1)  
[#2: Basic SQL]({{ site.url }}{{ site.baseurl }}/SQL2)  
[#3: SELECT]({{ site.url }}{{ site.baseurl }}/SQL3)  
[#4: Sorting]({{ site.url }}{{ site.baseurl }}/SQL4)  
[#6: INDEX]({{ site.url }}{{ site.baseurl }}/SQL6)  
[#7: Transactions]({{ site.url }}{{ site.baseurl }}/SQL7)  
[#8: Other Functions]({{ site.url }}{{ site.baseurl }}/SQL8)  
All the posts in this series are my personal note taking and may be updated as the course progresses.  

# Common Table Expressions
A CTE is a type of temporary table that can be used to help with complex multi-select queries. The syntax is:

```sql
;WITH cte 
AS
(
    SELECT ListPrice 
    FROM Production.Product
)
```

# Views
Views are like a CTE but without containing anything other than the query. Accessing a view will just run the query that is stored in that view making them very lightweight to store but not to run. 

# JOIN
A `JOIN` combines two or more tables into one. The only conditions for a join is that there is some common feature, which is given after the `ON` keyword.  
There are two commonly used `JOIN` types: `INNER JOIN` only joins where values exist in both columns, `OUTER JOIN` will include all distict values in the `LEFT` table listed as well as the common values (`LEFT` is default). The syntax involves a normal `FROM` detailing the first table with a surrogate, followed by the `JOIN` of the second table and the `ON` selecting the common column.   

The following query will output a table containing product names and colours from `Production.Product` along with an orderID and corresponding order quantity from `SalesOrderDetail` where the product ID is matched in both tables.  
```sql
SELECT
	 d.salesorderID
	,p.name
	,p.color
	,d.OrderQty
FROM sales.SalesOrderDetail d
INNER JOIN production.product p
	ON d.ProductID = p.ProductID
```

# Set Operations
Set operations are similar to `JOIN` operations but work row-wise. They're used between select statements.
`UNION` - Combines tables by row, removing duplicates
`UNION ALL` - Combines tables by row, keeping duplicates
`INTERSECT` - Returns rows that are common between tables
`EXCEPT` - Returns rows that are not common